---
title: Yslow-23条规则 前端性能优化
tags:
  - 前端性能
id: 197
categories:
  - 前端杂货
date: 2015-07-12 21:49:55
---

**什么是YSlow？ YSlow是Yahoo发布的一款基于FireFox的插件。**

**如何安装YSlow？**

**安装YSlow必须首先先安装 Firebug，然后下载YSlow，再对其安装。**

**YSlow有什么用？**

**YSlow可以对网站的页面进行分析，并告诉你为了提高网站性能，如何基于某些规则而进行优化。**

**YSlow可以分析任何网站，并为每一个规则产生一个整体报告，如果页面可以进行优化，则YSlow会列出具体的修改意见。**

**Yslow-23条规则：**

**1\. 减少HTTP请求次数**
合并图片、CSS、JS，改进首次访问用户等待时间。

**2\. 使用CDN**
就近缓存==>智能路由==>负载均衡==>WSA全站动态加速

**3\. 避免空的src和href**
当link标签的href属性为空、script标签的src属性为空的时候，浏览器渲染的时候会把当前页面的URL作为它们的属性值，从而把页面的内容加载进来作为它们的值。

**4\.为文件头指定Expires**

使内容具有缓存性。避免了接下来的页面访问中不必要的HTTP请求。

**5\. 使用gzip压缩内容**

压缩任何一个文本类型的响应，包括XML和JSON，都是值得的。

**6\. 把CSS放到顶部**

**7\. 把JS放到底部**

防止js加载对之后资源造成阻塞。

**8\. 避免使用CSS表达式**

**9\. 将CSS和JS放到外部文件中**

目的是缓存，但有时候为了减少请求，也会直接写到页面里，需根据PV和IP的比例权衡。

**10\. 权衡DNS查找次数**

减少主机名可以节省响应时间。但同时，需要注意，减少主机会减少页面中并行下载的数量。**
**IE浏览器在同一时刻只能从同一域名下载两个文件。当在一个页面显示多张图片时，IE 用户的图片下载速度就会受到影响。所以新浪会搞N个二级域名来放图片。

**11\. 精简CSS和JS**

**12\. 避免跳转**

同域：注意避免反斜杠 “/” 的跳转；

跨域：使用Alias或者mod_rewirte建立CNAME（保存域名与域名之间关系的DNS记录）

**13\. 删除重复的JS和CSS**

重复调用脚本，除了增加额外的HTTP请求外，多次运算也会浪费时间。在IE和Firefox中不管脚本是否可缓存，它们都存在重复运算JavaScript的问题。

**14\. 配置ETags**
它用来判断浏览器缓存里的元素是否和原来服务器上的一致。比last-modified date更具有弹性，例如某个文件在1秒内修改了10次，Etag可以综合Inode(文件的索引节点(inode)数)，MTime(修改时间)和Size来精准的进行判断，避开UNIX记录MTime只能精确到秒的问题。

服务器集群使用，可取后两个参数。使用ETags减少Web应用带宽和负载

**15\. 可缓存的AJAX**

“异步”并不意味着“即时”：Ajax并不能保证用户不会在等待异步的JavaScript和XML响应上花费时间。

**16\. 使用GET来完成AJAX请求**

当使用XMLHttpRequest时，浏览器中的POST方法是一个“两步走”的过程：首先发送文件头，然后才发送数据。因此使用GET获取数据时更加有意义。

**17\. 减少DOM元素数量**

是否存在一个是更贴切的标签可以使用？人生不仅仅是DIV+CSS

**18\. 避免404**

有些站点把404错误响应页面改为“你是不是要找***”，这虽然改进了用户体验但是同样也会浪费服务器资源（如数据库等）。最糟糕的情况是指向外部 JavaScript的链接出现问题并返回404代码。首先，这种加载会破坏并行加载；其次浏览器会把试图在返回的404响应内容中找到可能有用的部分当作JavaScript代码来执行。

**19\. 减少Cookie的大小**

**20\. 使用无cookie的域**

比如图片 CSS 等，Yahoo! 的静态文件都在主域名以外，客户端请求静态文件的时候，减少了 Cookie 的反复传输对主域名的影响。

**21\. 不要使用滤镜**
**    png24的在IE6半透明那种东西，别乱使，淡定的切成PNG8+jpg**

**22\. 不要在HTML中缩放图片**

**23\. 缩小favicon.ico并缓存**

**整理下来正如以下几点(重点)：**

**HTML部分**

语义化HTML：好处在于可以使代码简洁清晰，支持不同设备，利于搜索引擎，便于团队开发；

减少DOM节点：加速页面渲染；


给图片加上正确的宽高值：这可以减少页面重绘，同时防止图片缩放；

防止src属性和link的href属性为空：当值为空时，浏览器很可能会把当前页面当成其属性值加载；

正确的闭合标签：如避免使用`<div/>`，浏览器会多一个将它解析成`<div\></div\>`的过程；

链接为目录或首页的地址后面加”/”，如[http://www.qq.com/](http://www.qq.com/)；

用LINK而不用@import方式导入样式；

样式放在页头，JS放在页尾；

缩小favicon.ico并缓存；

**CSS部分**

避免使用 CSS:

Expressions(CSS表达式)：如background-color: expression( (new Date()).getHours()%2 ? “#B8D4FF” : “#F08A00″ ) ;

避免使用 CSS Filter（CSS滤镜）；

使用CSS缩写，减少代码量；

通过CSSSprites把同类图片合成一张，减少图片请求；

减少查询层级：如.header .logo要好过.header .top .logo；

减少查询范围：如.header>li要好过.header li；

避免TAG标签与CLASS或ID并存：如a.top、button#submit；

删除重复的CSS；

**Javscript部分**

尽量少用全局变量；

使用事件代理绑定事件，如将事件绑定在body上进行代理；

避免频繁操作DOM节点；

不使用EVAL；

减少对象查找，如a.b.c.d这种查找方式非常耗性能，尽可能把它定义在变量里；

类型转换：把数字转换成字符串使用”" + 

1，浮点数转换成整型使用Math.floor()或者Math.round()；

对字符串进行循环操作，譬如替换、查找，应使用正则表达式；

删除重复的JS；

**服务器部分**

尽量合并CSS、JS文件，或将其直接写在页面上，减少HTTP请求；

压缩CSS、JS文件，缩短文件传输时间；

避免404错误：特别要避免给404指定一个停摆页面，否则所有404错误都将会加载一次页面；

一般要求减少DNS查询次数，如同一个页面的请求资源尽量少的使用不同的主机名，这可以减少网站并行下载的数量，但很多网站为了加速下载资源其实是特意用了多个主机名，这里要做一个权衡；

使用CDN加速，使用户从离自己最近的服务器下载文件；

减少Cookie的大小，使用无cookie的域，客户端请求静态文件的时候，减少 Cookie 的反复传输对主域名的影响；

为文件头指定Expires，使内容具有缓存性；

使用gzip压缩内容；